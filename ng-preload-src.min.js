/*! ng-preload-src - v 0.0.2 - Wed Apr 23 2014 02:59:17 GMT+0800 (CST)
 * https://github.com/tomchentw/ng-preload-src
 * Copyright (c) 2014 [tomchentw](https://github.com/tomchentw);
 * Licensed [MIT](http://tomchentw.mit-license.org)
 */
(function(t,e,r){t.module("ng-preload-src",[]).factory("$image",["$window","$q","$injector"].concat(function(a,n,o){function i(t){c.complete(),this.resolve(t)}var c;return c=o.get("cfpLoadingBar")||{start:r,complete:r},{preload:function(r){var o,s;return o=n.defer(),s=new a.Image,s.src=r,c.start(0),t.element(s).on("load",e(o,i,r)),o.promise}}})).directive("preloadWithDefaultSrc",["$interpolate","$image"].concat(function(t,r){var a;return a=function(){function a(r,a){this.$scope=r,this.$attrs=a,this.lastUrl=void 0,this.onImageLoaded=e(this,this.onImageLoaded),r.$watch(t(a.preloadSrc),e(this,this.onSrcChanged))}a.displayName="PreloadCtrl";var n=a.prototype;return n.onSrcChanged=function(t){this.$attrs.$set("ngSrc",this.$attrs.preloadWithDefaultSrc),this.lastUrl=t,r.preload(t).then(this.onImageLoaded)},n.onImageLoaded=function(t){this.lastUrl===t&&this.$attrs.$set("ngSrc",t)},a.$inject=["$scope","$attrs"],a}(),{controller:a,compile:function(t,e){e.$set("preloadSrc",e.ngSrc),e.$set("ngSrc",e.preloadWithDefaultSrc)}}}))}).call(this,angular,angular.bind,angular.noop);